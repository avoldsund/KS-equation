% Rk4


close all
clear all


f = @(x) cos(x/16).*(1+sin(x/16));


M = 10;
h = (32*pi)/(M-1);
k = 0.0001;

x = 0:(M-1)*h;
N = 1000;


t = linspace(0,(N+1)*k,N+1);
U(:,1) = f(x);

e = ones(M,1);

s = [-M+1 -1:1 M-1];
A = spdiags([e, e, -2*e, e, e], s,M,M);
p = [-M+1 -M+2 -2:2 M-2 M-1];
B = spdiags([e, -4*e, e, -4*e, 6*e, -4*e, e, -4*e, e],p,M,M);

C = @(U) spdiags([